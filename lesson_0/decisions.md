# Описание принятых решений

## Архитектура сервисов

Так как один из консернов - это time to market, было принято решение создать монолит (Task Platform) с большей частью логики:
- Task Module, содержаший информацию о заказах ([US-030])
- Tools Module, содержащий логику предоставления расходников для заказов
- Bets Module, содержащий логику ставок на заказы

Помимо монолита отдельно выделены:
- Billing Service - асинхронный сервис биллинга, осуществляющий:
  - выплаты воркерам ([US-200], [US-210])
  - списание средств у клиентов ([US-190])
  - Bookkeeping и статистика по списаниям/выплатам([US-220], [US-230])
  - Логика по дополнительному начислению средств (extra payment) ([US-240])
- Асинхронный биллинг позволяет выделить всю сложность связанную с bookkeeping'ом, payments в отдельные домены внутри сервиса
и хорошо ложится на асинхронную модель взаимодейтсвий (через эвенты через очередь/распределенный коммит лог)
- Workers Assessment Service - Сервис для тестирования новых воркеров ([US-080]). У него отдельный BE + FE и новые воркеры 
синхронизируются с Task Platform асинхронно.
  - Решение выделить Workers Assessment Service в отдельный сервис было принято, чтобы решить проблему масштабируемости 
из-за ожидаемых высоких нагрузок ([US-081])

## Остальные решения

* Доступ к необходимым данным для менеджеров/воркеров/клиентов будет осуществяться с помощью permissions к одним и тем
же модулям (billing, tasks, и т д) через единый API BFF. При этом для ролей будут использованы разные layout'ы, а в дальнейшем 
и разные FE приложения.
* Создается отдельная сущность Engagement когда воркер берет заказ ([US-070]). Ее GID c необходимыми данным передается
в Tools Module для выдачи расходников и отправляется в External API для получения печенья.
* Для печенья [US-150] было решено из Task Module отправлять бизнес-событие Engagement Started, содержащие GID engagement'a 
в Tools Module и в external API подрядчика, предоставляющего печенье. Печенье будет в дальнейшем доставлено в отдел расходинков 
и идентифицированно с помощью GID.
* Несмотря на наличие требований для нотификаций ([US-270]) было решено не выделять отдельный модуль/сервис под нотификации 
по крайней мере на первом этапе развития проекта из-за time to market constraint'a. Будет использована единая библиотекта 
для отправки нотификаций и единая конфигурация для них и в будущем в случае необходиости будет создан отдельный сервис для нотификаций.
